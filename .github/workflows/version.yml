name: Version
on:
  workflow_call:
    outputs:
      version:
        description: "The complete version string"
        value: ${{ jobs.version.outputs.version }}

jobs:
  version:
    runs-on: ubuntu-latest
    outputs:
      version: ${{ steps.complete-version.outputs.version }}
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - uses: paulhatch/semantic-version@v5.3.0
        id: semantic-version
      - run: |
          echo "Version: ${{ steps.semantic-version.outputs.version }}"
          echo "Major: ${{ steps.semantic-version.outputs.major }}"
          echo "Minor: ${{ steps.semantic-version.outputs.minor }}"
          echo "Patch: ${{ steps.semantic-version.outputs.patch }}"
          echo "Version type: ${{ steps.semantic-version.outputs.version_type }}"
          echo "Version tag: ${{ steps.semantic-version.outputs.version_tag }}"
          echo "Changed: ${{ steps.semantic-version.outputs.changed }}"
          echo "Increment: ${{ steps.semantic-version.outputs.increment }}"
          echo "Current commit: ${{ steps.semantic-version.outputs.current_commit }}"
          echo "Is tagged: ${{ steps.semantic-version.outputs.is_tagged }}"
      - id: complete-version
        run: echo "version=${{ steps.semantic-version.outputs.version }}-$GITHUB_HEAD_REF-${{ steps.semantic-version.outputs.increment }}" >> "$GITHUB_OUTPUT"
